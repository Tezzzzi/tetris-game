<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Tetris Bright Mobile</title>
<style>
:root {
  --neon: #00ffff;
}
body {
  margin: 0;
  overflow: hidden;
  background: #000;
  color: #fff;
  font-family: "Poppins", sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  height: 100vh;
}

/* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
#gameContainer {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  justify-content: center;
  gap: 3vw;
  width: 100%;
  height: 80vh;
}

/* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
#tetris {
  background: #000;
  border: 3px solid var(--neon);
  box-shadow: 0 0 15px var(--neon), 0 0 30px var(--neon), inset 0 0 10px var(--neon);
  border-radius: 10px;
  flex-shrink: 0;
}

/* –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
#ui {
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid var(--neon);
  box-shadow: 0 0 10px var(--neon);
  border-radius: 10px;
  padding: 15px 25px;
  min-width: 180px;
  text-align: left;
}
#ui h1 { font-size: 20px; margin-bottom: 10px; }
#ui p { font-size: 15px; margin: 4px 0; }

/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –±–æ–º–±—ã */
#bombReady {
  color: red;
  font-weight: bold;
  animation: blink 1s infinite;
  visibility: hidden;
}
@keyframes blink { 0%,100%{opacity:1;}50%{opacity:0;} }

/* –ü—Ä–µ–≤—å—é */
#next {
  margin-top: 10px;
  border: 2px solid var(--neon);
  box-shadow: 0 0 10px var(--neon);
  border-radius: 5px;
}

/* –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ä—Ç–∞ / –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è */
#startScreen, #gameOver {
  position: fixed;
  inset: 0;
  background: #000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
}
#startScreen button, #gameOver button {
  font-size: 22px;
  padding: 12px 30px;
  border: none;
  border-radius: 8px;
  background: var(--neon);
  color: #000;
  cursor: pointer;
  box-shadow: 0 0 15px var(--neon);
  transition: transform 0.1s ease, box-shadow 0.2s ease;
}
#startScreen button:hover, #gameOver button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 25px var(--neon);
}

/* --- üéÆ –ú–æ–±–∏–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è --- */
#mobileControls {
  display: none;
  position: fixed;
  bottom: 2vh;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  justify-content: space-around;
  z-index: 5;
}
.control-btn {
  background: var(--neon);
  color: #000;
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 20px;
  box-shadow: 0 0 15px var(--neon);
  cursor: pointer;
}

/* --- üì± –ê–¥–∞–ø—Ç–∏–≤ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ --- */
@media (max-width: 768px) {
  #gameContainer {
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80vh;
  }
  #ui {
    order: -1;
    margin-bottom: 10px;
    min-width: auto;
    text-align: center;
  }
  #mobileControls {
    display: flex;
  }
}
</style>
</head>

<body>
<div id="startScreen">
  <h1 style="font-size:40px;">Tetris Bright</h1>
  <button id="startBtn">Play!</button>
</div>

<div id="gameOver" style="display:none;">
  <h1 style="font-size:36px;">Game Over</h1>
  <button id="restartBtn">Play Again</button>
</div>

<div id="gameContainer">
  <canvas id="tetris"></canvas>
  <div id="ui">
    <h1>Stats</h1>
    <p>Score: <span id="score">0</span></p>
    <p>Level: <span id="level">1</span></p>
    <p>Bonus: <span id="bonus">0</span></p>
    <p>Bombs: <span id="bombs">0</span></p>
    <p id="bombReady">Bomb Ready!</p>
    <p style="font-size:13px;color:#ccc;">Controls:<br>
    ‚Üê ‚Üí Move<br>‚Üë Rotate<br>‚Üì Soft Drop<br>Space Hard Drop<br>P Pause<br>B Use Bomb</p>
    <p>Next:</p>
    <canvas id="next" width="80" height="80"></canvas>
  </div>
</div>

<!-- –ú–æ–±–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
<div id="mobileControls">
  <button class="control-btn" id="leftBtn">‚Üê</button>
  <button class="control-btn" id="rotateBtn">‚ü≥</button>
  <button class="control-btn" id="dropBtn">‚Üì</button>
  <button class="control-btn" id="rightBtn">‚Üí</button>
  <button class="control-btn" id="bombBtn">üí£</button>
</div>

<script>
const tetris = document.getElementById("tetris");
const context = tetris.getContext("2d");
const nextCanvas = document.getElementById("next");
const nextCtx = nextCanvas.getContext("2d");

function resizeCanvas() {
  const vh = window.innerHeight * 0.75;
  const ratio = 12 / 20;
  tetris.height = vh;
  tetris.width = vh * ratio;
  context.setTransform(tetris.width / 12, 0, 0, tetris.height / 20, 0, 0);
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

const colors=[null,'#ff4040','#40ff40','#4040ff','#ffff40','#ff40ff','#40ffff','#ff8000','#ff2222'];
const arena=createMatrix(12,20);
const player={pos:{x:0,y:0},matrix:null,next:null,score:0,level:1,bonus:0,bombs:0,isBomb:false};

let running=false,paused=false,lastTime=0,dropCounter=0,dropInterval=1000;

function createMatrix(w,h){const m=[];while(h--)m.push(new Array(w).fill(0));return m;}
function createPiece(t){switch(t){case'T':return[[0,1,0],[1,1,1]];case'O':return[[2,2],[2,2]];case'L':return[[0,3,0],[0,3,0],[0,3,3]];case'J':return[[0,4,0],[0,4,0],[4,4,0]];case'I':return[[0,5,0,0],[0,5,0,0],[0,5,0,0],[0,5,0,0]];case'S':return[[0,6,6],[6,6,0]];case'Z':return[[7,7,0],[0,7,7]];}}
function drawMatrix(matrix,offset,ctx=context){matrix.forEach((r,y)=>r.forEach((v,x)=>{if(v!==0){ctx.fillStyle=colors[v];ctx.fillRect(x+offset.x,y+offset.y,1,1);}}));}
function draw(){context.fillStyle='#000';context.fillRect(0,0,12,20);drawMatrix(arena,{x:0,y:0});drawMatrix(player.matrix,player.pos);}
function collide(a,p){const[m,o]=[p.matrix,p.pos];for(let y=0;y<m.length;y++)for(let x=0;x<m[y].length;x++)if(m[y][x]!==0&&(a[y+o.y]&&a[y+o.y][x+o.x])!==0)return true;return false;}
function merge(a,p){p.matrix.forEach((r,y)=>r.forEach((v,x)=>{if(v!==0)a[y+p.pos.y][x+p.pos.x]=v;}));}
function rotate(m,d){for(let y=0;y<m.length;y++)for(let x=0;x<y;x++) [m[x][y],m[y][x]]=[m[y][x],m[x][y]];if(d>0)m.forEach(r=>r.reverse());else m.reverse();}
function playerMove(d){player.pos.x+=d;if(collide(arena,player))player.pos.x-=d;}
function dropDown(){while(!collide(arena,player))player.pos.y++;player.pos.y--;playerDrop();}
function playerDrop(){player.pos.y++;if(collide(arena,player)){player.pos.y--;if(player.isBomb)explode(player.pos);else{merge(arena,player);arenaSweep();}playerReset();}dropCounter=0;}

function flashEffect(pos){ // üí• —É–ª—É—á—à–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
  const flash=document.createElement("div");
  flash.style.position="absolute";
  flash.style.left=`${tetris.getBoundingClientRect().left}px`;
  flash.style.top=`${tetris.getBoundingClientRect().top}px`;
  flash.style.width=`${tetris.clientWidth}px`;
  flash.style.height=`${tetris.clientHeight}px`;
  flash.style.background="radial-gradient(circle, rgba(255,50,50,0.5) 0%, rgba(255,0,0,0) 70%)";
  flash.style.pointerEvents="none";
  flash.style.transition="opacity 0.5s";
  document.body.appendChild(flash);
  setTimeout(()=>flash.style.opacity="0",50);
  setTimeout(()=>flash.remove(),600);
}

function explode(pos){
  flashEffect(pos);
  for(let y=-1;y<=1;y++)
    for(let x=-1;x<=1;x++){
      const Y=pos.y+y,X=pos.x+x;
      if(arena[Y]&&arena[Y][X]>0)arena[Y][X]=0;
    }
}

function arenaSweep(){let lines=0;outer:for(let y=arena.length-1;y>=0;--y){for(let x=0;x<arena[y].length;x++)if(arena[y][x]===0)continue outer;arena.splice(y,1);arena.unshift(new Array(arena[0].length).fill(0));++y;lines++;}if(lines>0){player.score+=lines*10;if(lines>=2){player.bonus+=lines===2?1:(lines===3?3:6);if(player.bonus>=10){player.bonus-=10;player.bombs++;}}}}
function playerReset(){player.isBomb=false;player.matrix=player.next;player.next=createPiece(pieces[(pieces.length*Math.random())|0]);player.pos.y=0;player.pos.x=(arena[0].length/2|0)-(player.matrix[0].length/2|0);if(collide(arena,player)){arena.forEach(r=>r.fill(0));document.getElementById('gameOver').style.display='flex';running=false;}}
function update(time=0){if(!running||paused)return;const delta=time-lastTime;lastTime=time;dropCounter+=delta;if(dropCounter>dropInterval)playerDrop();draw();updateScore();requestAnimationFrame(update);}
function updateScore(){document.getElementById('score').innerText=player.score;document.getElementById('level').innerText=player.level;document.getElementById('bonus').innerText=player.bonus;document.getElementById('bombs').innerText=player.bombs;document.getElementById('bombReady').style.visibility=player.bombs>0?'visible':'hidden';}

document.addEventListener('keydown',e=>{
  if(!running)return;
  if(e.key==='ArrowLeft')playerMove(-1);
  else if(e.key==='ArrowRight')playerMove(1);
  else if(e.key==='ArrowDown')playerDrop();
  else if(e.key==='ArrowUp')rotate(player.matrix,1);
  else if(e.key===' ')dropDown();
  else if(e.key.toLowerCase()==='p'){paused=!paused;if(!paused){lastTime=performance.now();requestAnimationFrame(update);}}
  else if(e.key.toLowerCase()==='b'&&player.bombs>0&&!player.isBomb){player.isBomb=true;player.bombs--;player.matrix=[[8]];player.pos={x:5,y:0};}
});

['leftBtn','rightBtn','dropBtn','rotateBtn','bombBtn'].forEach(id=>{
  document.getElementById(id).addEventListener('click',()=>{
    if(id==='leftBtn')playerMove(-1);
    if(id==='rightBtn')playerMove(1);
    if(id==='dropBtn')playerDrop();
    if(id==='rotateBtn')rotate(player.matrix,1);
    if(id==='bombBtn'&&player.bombs>0&&!player.isBomb){player.isBomb=true;player.bombs--;player.matrix=[[8]];player.pos={x:5,y:0};}
  });
});

const pieces='ILJOTSZ'.split('');
function startGame(){
  document.getElementById('startScreen').style.display='none';
  document.getElementById('gameOver').style.display='none';
  arena.forEach(r=>r.fill(0));
  Object.assign(player,{score:0,level:1,bonus:0,bombs:0});
  player.next=createPiece(pieces[Math.random()*pieces.length|0]);
  playerReset();running=true;paused=false;lastTime=0;requestAnimationFrame(update);
}
document.getElementById('startBtn').onclick=startGame;
document.getElementById('restartBtn').onclick=startGame;
setInterval(()=>{const lv=Math.floor(player.score/100)+1;if(lv>player.level){player.level=lv;dropInterval=Math.max(200,1000-lv*80);}updateScore();},300);
updateScore();
</script>
</body>
</html>
